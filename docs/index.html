<h1 id="nz-util">nz-util</h1>
<p>Netezza utility functions</p>
<h1 id="installation">Installation</h1>
<h2 id="download-the-code">Download the code</h2>
<p>If you are on a Linux box (for example the Netezza frontend itself), you can try with this command</p>
<pre><code class="lang-bash">wget --no-check-certificate --timestamping https://raw.github.com/fibo/nz-util/master/nz_util.sql</code></pre>
<h2 id="install">Install</h2>
<pre><code class="lang-bash">nzsql -u admin -d system -c &#39;CREATE DATABASE util COLLECT HISTORY OFF&#39;
nzsql -u admin -d util -f nz_util.sql</code></pre>
<h2 id="update">Update</h2>
<p>Check current version</p>
<pre><code class="lang-bash">nzsql -u admin -d util -c &#39;\dd util&#39;</code></pre>
<p>Update <em>Netezza utilities</em>.</p>
<pre><code class="lang-bash">nzsql -u admin -d util -f nz_util.sql</code></pre>
<h1 id="utilities">Utilities</h1>
<h2 id="type-checking">Type checking</h2>
<h2 id="class_of">class_of</h2>
<p>Return the object class.</p>
<pre><code class="lang-sql">CALL util..class_of(&#39;FOO&#39;);</code></pre>
<ul>
<li><em>object_name</em> is not case sensitive</li>
</ul>
<h2 id="groups-and-grants-management">Groups and grants management</h2>
<h3 id="create_or_update_group">create_or_update_group</h3>
<p>Create a group safely. If group already exists, it will be granted to list current catalog.
Please note that since Netezza grants permissions contextually to current catalog,
you need to connect manually to catalog.</p>
<pre><code class="lang-sql">\c mydatabase
CALL util..create_or_update_group(&#39;GROUP_NAME&#39;);</code></pre>
<ul>
<li>avoids creating groups in reserved catalogs</li>
<li>checks if group already exists</li>
</ul>
<h3 id="grant_readonly">grant_readonly</h3>
<p>Grant a group to read data in current catalog.</p>
<pre><code class="lang-sql">\c mydatabase
CALL util..grant_readonly(&#39;GROUP_NAME&#39;);</code></pre>
<ul>
<li>creates group if it does not exists</li>
</ul>
<h3 id="grant_readwrite">grant_readwrite</h3>
<p>Grant a group to read and write data in current catalog.</p>
<pre><code class="lang-sql">\c mydatabase
CALL util..grant_readwrite(&#39;GROUP_NAME&#39;);</code></pre>
<ul>
<li>creates group if it does not exists</li>
</ul>
<h3 id="grant_systemview">grant_systemview</h3>
<p>Grant a group to read system views in current catalog.</p>
<pre><code class="lang-sql">\c mydatabase
CALL util..grant_systemview(&#39;GROUP_NAME&#39;);</code></pre>
<ul>
<li>creates group if it does not exists</li>
</ul>
<h3 id="grant_execute">grant_execute</h3>
<p>Grant a group to edit and call stored procedures in current catalog.</p>
<pre><code class="lang-sql">\c mydatabase
CALL util..grant_execute(&#39;GROUP_NAME&#39;);</code></pre>
<ul>
<li>creates group if it does not exists<h1 id="development">Development</h1>
</li>
</ul>
<h2 id="generate-docs">Generate docs</h2>
<p>Documentation is generated extracting comments with a <code>--</code> in the beginning of line.</p>
<pre><code class="lang-sql">/* This kind of comments will be ignored */</code></pre>
<p>The following commands work also from Git shell on Windows.</p>
<h3 id="generate-readme-md">Generate README.md</h3>
<pre><code class="lang-bash">grep -E &#39;^--&#39; nz_util.sql | sed -e &#39;s/--//&#39; &gt; README.md</code></pre>
<h3 id="generate-html-docs">Generate html docs</h3>
<p>Install <a href="https://github.com/chjj/marked">marked</a> globally <strong>only once</strong>.</p>
<pre><code class="lang-bash">npm install marked -g</code></pre>
<p>Create docs/index.html from README.md</p>
<pre><code class="lang-bash">marked -o docs/index.html README.md</code></pre>
<p>Update site</p>
<pre><code class="lang-bash">git subtree --prefix docs push origin gh-pages</code></pre>
